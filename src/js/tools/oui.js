export const ouiDatabase = [
  { prefix: "00:00:0C", vendor: "Cisco Systems, Inc" },
  { prefix: "00:01:42", vendor: "Cisco Systems, Inc" },
  { prefix: "00:01:43", vendor: "Cisco Systems, Inc" },
  { prefix: "00:01:C7", vendor: "Cisco Systems, Inc" },
  { prefix: "00:01:C9", vendor: "Cisco Systems, Inc" },
  { prefix: "00:02:16", vendor: "Cisco Systems, Inc" },
  { prefix: "00:02:17", vendor: "Cisco Systems, Inc" },
  { prefix: "00:02:4A", vendor: "Cisco Systems, Inc" },
  { prefix: "00:02:4B", vendor: "Cisco Systems, Inc" },
  { prefix: "00:02:7D", vendor: "Cisco Systems, Inc" },
  { prefix: "00:02:7E", vendor: "Cisco Systems, Inc" },
  { prefix: "00:02:AA", vendor: "Cisco Systems, Inc" },
  { prefix: "00:02:AB", vendor: "Cisco Systems, Inc" },
  { prefix: "00:02:B9", vendor: "Cisco Systems, Inc" },
  { prefix: "00:02:BA", vendor: "Cisco Systems, Inc" },
  { prefix: "00:02:FC", vendor: "Cisco Systems, Inc" },
  { prefix: "00:02:FD", vendor: "Cisco Systems, Inc" },
  { prefix: "00:03:31", vendor: "Cisco Systems, Inc" },
  { prefix: "00:03:32", vendor: "Cisco Systems, Inc" },
  { prefix: "00:03:6B", vendor: "Cisco Systems, Inc" },
  { prefix: "00:03:6C", vendor: "Cisco Systems, Inc" },
  { prefix: "00:03:9F", vendor: "Cisco Systems, Inc" },
  { prefix: "00:03:A0", vendor: "Cisco Systems, Inc" },
  { prefix: "00:03:E3", vendor: "Cisco Systems, Inc" },
  { prefix: "00:03:E4", vendor: "Cisco Systems, Inc" },
  { prefix: "00:03:FE", vendor: "Cisco Systems, Inc" },
  { prefix: "00:03:FF", vendor: "Cisco Systems, Inc" },
  { prefix: "00:04:27", vendor: "Cisco Systems, Inc" },
  { prefix: "00:04:28", vendor: "Cisco Systems, Inc" },
  { prefix: "00:04:4D", vendor: "Cisco Systems, Inc" },
  { prefix: "00:04:4E", vendor: "Cisco Systems, Inc" },
  { prefix: "00:04:6D", vendor: "Cisco Systems, Inc" },
  { prefix: "00:04:6E", vendor: "Cisco Systems, Inc" },
  { prefix: "00:04:9A", vendor: "Cisco Systems, Inc" },
  { prefix: "00:04:9B", vendor: "Cisco Systems, Inc" },
  { prefix: "00:04:C0", vendor: "Cisco Systems, Inc" },
  { prefix: "00:04:C1", vendor: "Cisco Systems, Inc" },
  { prefix: "00:04:DD", vendor: "Cisco Systems, Inc" },
  { prefix: "00:04:DE", vendor: "Cisco Systems, Inc" },
  { prefix: "00:05:00", vendor: "Cisco Systems, Inc" },
  { prefix: "00:05:01", vendor: "Cisco Systems, Inc" },
  { prefix: "00:05:31", vendor: "Cisco Systems, Inc" },
  { prefix: "00:05:32", vendor: "Cisco Systems, Inc" },
  { prefix: "00:05:5E", vendor: "Cisco Systems, Inc" },
  { prefix: "00:05:5F", vendor: "Cisco Systems, Inc" },
  { prefix: "00:05:73", vendor: "Cisco Systems, Inc" },
  { prefix: "00:05:74", vendor: "Cisco Systems, Inc" },
  { prefix: "00:05:9A", vendor: "Cisco Systems, Inc" },
  { prefix: "00:05:9B", vendor: "Cisco Systems, Inc" },
  { prefix: "00:05:DC", vendor: "Cisco Systems, Inc" },
  { prefix: "00:00:00", vendor: "Xerox Corporation" },
  { prefix: "00:00:AA", vendor: "Xerox Corporation" },
  { prefix: "00:0A:95", vendor: "Apple, Inc." },
  { prefix: "00:10:FA", vendor: "Apple, Inc." },
  { prefix: "00:11:24", vendor: "Apple, Inc." },
  { prefix: "00:14:51", vendor: "Apple, Inc." },
  { prefix: "00:16:CB", vendor: "Apple, Inc." },
  { prefix: "00:17:F2", vendor: "Apple, Inc." },
  { prefix: "00:19:E3", vendor: "Apple, Inc." },
  { prefix: "00:1B:63", vendor: "Apple, Inc." },
  { prefix: "00:1C:B3", vendor: "Apple, Inc." },
  { prefix: "00:1D:4F", vendor: "Apple, Inc." },
  { prefix: "00:1E:52", vendor: "Apple, Inc." },
  { prefix: "00:1E:C2", vendor: "Apple, Inc." },
  { prefix: "00:1F:5B", vendor: "Apple, Inc." },
  { prefix: "00:1F:F3", vendor: "Apple, Inc." },
  { prefix: "00:21:E9", vendor: "Apple, Inc." },
  { prefix: "00:22:41", vendor: "Apple, Inc." },
  { prefix: "00:23:12", vendor: "Apple, Inc." },
  { prefix: "00:23:32", vendor: "Apple, Inc." },
  { prefix: "00:23:6C", vendor: "Apple, Inc." },
  { prefix: "00:23:DF", vendor: "Apple, Inc." },
  { prefix: "00:24:36", vendor: "Apple, Inc." },
  { prefix: "00:25:00", vendor: "Apple, Inc." },
  { prefix: "00:25:4B", vendor: "Apple, Inc." },
  { prefix: "00:25:BC", vendor: "Apple, Inc." },
  { prefix: "00:26:08", vendor: "Apple, Inc." },
  { prefix: "00:26:4A", vendor: "Apple, Inc." },
  { prefix: "00:26:B0", vendor: "Apple, Inc." },
  { prefix: "00:26:BB", vendor: "Apple, Inc." },
  { prefix: "00:50:56", vendor: "VMware, Inc." },
  { prefix: "00:0C:29", vendor: "VMware, Inc." },
  { prefix: "00:05:69", vendor: "VMware, Inc." },
  { prefix: "00:1C:14", vendor: "VMware, Inc." },
  { prefix: "00:15:5D", vendor: "Microsoft Corporation" },
  { prefix: "00:03:FF", vendor: "Microsoft Corporation" },
  { prefix: "00:12:5A", vendor: "Microsoft Corporation" },
  { prefix: "DC:A6:32", vendor: "Raspberry Pi Trading Ltd" },
  { prefix: "B8:27:EB", vendor: "Raspberry Pi Foundation" },
  { prefix: "E4:5F:01", vendor: "Raspberry Pi Trading Ltd" },
  { prefix: "D8:3A:DD", vendor: "Raspberry Pi Trading Ltd" },
  { prefix: "28:CD:C1", vendor: "Raspberry Pi Trading Ltd" },
  { prefix: "2C:CF:67", vendor: "Raspberry Pi Trading Ltd" },
  { prefix: "18:66:DA", vendor: "Dell Inc." },
  { prefix: "00:14:22", vendor: "Dell Inc." },
  { prefix: "00:23:AE", vendor: "Dell Inc." },
  { prefix: "2C:41:38", vendor: "Hewlett Packard" },
  { prefix: "00:1C:C4", vendor: "Hewlett Packard" },
  { prefix: "00:9C:02", vendor: "Hewlett Packard" },
  { prefix: "00:1B:78", vendor: "Hewlett Packard" },
  { prefix: "3C:D9:2B", vendor: "Hewlett Packard" },
  { prefix: "00:0E:7F", vendor: "Hewlett Packard" },
  { prefix: "00:11:0A", vendor: "Hewlett Packard" },
  { prefix: "00:11:85", vendor: "Hewlett Packard" },
  { prefix: "00:12:79", vendor: "Hewlett Packard" },
  { prefix: "00:13:21", vendor: "Hewlett Packard" },
  { prefix: "00:14:38", vendor: "Hewlett Packard" },
  { prefix: "00:14:C2", vendor: "Hewlett Packard" },
  { prefix: "00:15:60", vendor: "Hewlett Packard" },
  { prefix: "00:16:35", vendor: "Hewlett Packard" },
  { prefix: "00:17:08", vendor: "Hewlett Packard" },
  { prefix: "00:25:90", vendor: "Super Micro Computer, Inc." },
  { prefix: "00:30:48", vendor: "Super Micro Computer, Inc." },
  { prefix: "0C:C4:7A", vendor: "Super Micro Computer, Inc." },
  { prefix: "00:01:29", vendor: "Juniper Networks" },
  { prefix: "00:05:85", vendor: "Juniper Networks" },
  { prefix: "00:10:DB", vendor: "Juniper Networks" },
  { prefix: "54:E0:32", vendor: "Juniper Networks" },
  { prefix: "00:D0:B7", vendor: "Intel Corporate" },
  { prefix: "00:1B:21", vendor: "Intel Corporate" },
];

export function initOuiTool(container) {
  // 1. Render UI
  container.innerHTML = `
    <div class="max-w-2xl mx-auto space-y-6">
        <div class="bg-surface-dark cyber-border rounded p-6">
             <div class="relative">
                <span class="material-symbols-outlined absolute left-4 top-3 text-slate-500">search</span>
                <input id="oui-search" type="text" placeholder="Search MAC Vendor (e.g. 00:50:56 or Cisco)" 
                       class="w-full bg-black border border-border-dark rounded-full pl-12 pr-4 py-3 text-white focus:border-purple-500 transition-colors uppercase">
             </div>
        </div>

        <div id="oui-results" class="space-y-4">
             <div class="text-center text-slate-500 py-8">
                 <span class="material-symbols-outlined text-4xl mb-2">database</span>
                 <p class="text-sm">Enter a MAC address prefix or Vendor name to search.</p>
             </div>
        </div>
    </div>
  `;

  const searchInput = container.querySelector("#oui-search");
  const resultsContainer = container.querySelector("#oui-results");

  function render(entries) {
    if (entries.length === 0) {
      resultsContainer.innerHTML = `
        <div class="bg-surface-dark cyber-border rounded p-8 text-center text-slate-500">
            No matches found in offline database.
        </div>`;
      return;
    }

    resultsContainer.innerHTML = entries
      .map(
        e => `
      <div class="bg-surface-dark cyber-border rounded p-4 flex items-center justify-between hover:border-purple-500 transition-colors group">
        <div>
          <h3 class="font-mono text-purple-400 text-lg font-bold group-hover:text-purple-300 transition-colors">${e.prefix}</h3>
          <div class="text-white font-bold text-sm">${e.vendor}</div>
        </div>
        <div class="size-10 bg-purple-500/10 rounded-full flex items-center justify-center text-purple-500 group-hover:bg-purple-500 group-hover:text-white transition-colors">
            <span class="material-symbols-outlined">business</span>
        </div>
      </div>
    `
      )
      .join("");
  }

  searchInput.addEventListener("input", e => {
    const rawVal = e.target.value;
    const term = rawVal.replace(/[:.-]/g, "").toUpperCase();

    if (term.length === 0) {
      resultsContainer.innerHTML = `
         <div class="text-center text-slate-500 py-8">
             <span class="material-symbols-outlined text-4xl mb-2">database</span>
             <p class="text-sm">Enter a MAC address prefix or Vendor name to search.</p>
         </div>`;
      return;
    }

    const filtered = ouiDatabase.filter(e => {
      const dbPrefix = e.prefix.replace(/:/g, "");
      return dbPrefix.includes(term) || e.vendor.toLowerCase().includes(rawVal.toLowerCase());
    });

    render(filtered.slice(0, 50));
  });
}
